<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>v8: V8 Sandbox - Glossary</title>
<link rel="icon" href="v8.svg" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="v8.svg"/></td>
  <td id="projectalign">
   <div id="projectname">v8
   </div>
   <div id="projectbrief">V8 is Google’s open source high-performance JavaScript and WebAssembly engine, written in C++. It is used in Chrome and in Node.js, among others. It implements ECMAScript and WebAssembly, and runs on Windows, macOS, and Linux systems that use x64, IA-32, or ARM processors. V8 can be embedded into any C++ application.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">V8 Sandbox - Glossary</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md7"></a></p>
<p>This glossary explains the technical terms used in the context of the V8 Sandbox. For a general overview of the sandbox see the <a href="https://docs.google.com/document/d/1FM4fQmIhEqPG8uGp5o9A-mnPB5BOeScZYpkHjo0KKA8/edit?usp=sharing">high-level design document</a>.</p>
<h1><a class="anchor" id="autotoc_md8"></a>
General</h1>
<h2><a class="anchor" id="autotoc_md9"></a>
Sandbox</h2>
<p><b>Summary</b>: A region of virtual address space (typically 1TB) containing all untrusted V8 objects.<br  />
 <b>Implementation</b>: This is implemented as a large, contiguous virtual address space reservation using the appropriate operating system primitives. Address space reservations are cheap on all modern OSes.<br  />
 <b>Security Properties:</b> It is assumed that an attacker can arbitrarily read and write memory inside the sandbox address space due to a typical security bug in V8. The mechanisms described in this document, in particular the various pointer types, then attempt to prevent an attacker from corrupting other memory inside the process running V8.<br  />
 <b>Design Document</b>: <a href="https://docs.google.com/document/d/1PM4Zqmlt8ac5O8UNQfY7fOsem-6MhbsB-vjFI-9XK6w/edit?usp=sharing">V8 Sandbox - Address Space</a></p>
<h1><a class="anchor" id="autotoc_md10"></a>
Objects</h1>
<p>This section gives an overview of the different object types related to the sandbox.</p>
<h2><a class="anchor" id="autotoc_md11"></a>
TrustedObject</h2>
<p><b>Summary</b>: A V8 HeapObject containing sensitive data or code, located outside of the sandbox.<br  />
 <b>Implementation</b>: These are regular HeapObjects with a special instance type and which are allocated in one of the trusted heap spaces, located outside of the sandbox.<br  />
 <b>Security Properties</b>: As these objects live outside of the sandbox, it can be assumed that they have not been manipulated by an attacker. As such, they can safely be read from, but one must be particularly careful when writing to them to avoid any memory corruption in trusted space.<br  />
 <b>Design Document</b>: <a href="https://docs.google.com/document/d/1IrvzL4uX_Zv0k2Iakdp_q_z33bj-qlYF5IesGpXW0fM/edit?usp=sharing">V8 Sandbox - Trusted Space</a></p>
<h2><a class="anchor" id="autotoc_md12"></a>
ExposedTrustedObject</h2>
<p><b>Summary</b>: A trusted object directly exposed to objects inside the sandbox.<br  />
 <b>Implementation</b>: These objects own an entry in one of the trusted pointer tables and therefore can be referenced from inside the sandbox in a memory-safe way via a trusted pointer (see below).<br  />
 <b>Security Properties</b>: Same as TrustedObject.<br  />
 <b>Design Document</b>: <a href="https://docs.google.com/document/d/1IrvzL4uX_Zv0k2Iakdp_q_z33bj-qlYF5IesGpXW0fM/edit?usp=sharing">V8 Sandbox - Trusted Space</a></p>
<h1><a class="anchor" id="autotoc_md13"></a>
Pointers</h1>
<p>This section gives an overview of the different pointer types used by the sandbox.</p>
<h2><a class="anchor" id="autotoc_md14"></a>
Compressed Pointer</h2>
<p><b>Summary</b>: A pointer that is guaranteed to point into V8’s 4GB heap area, inside the sandbox.<br  />
 <b>Implementation</b>: These are stored as 32-bit offsets from the start of the heap area. They were originally developed to reduce V8’s memory footprint.<br  />
 <b>Security Properties</b>: As this pointer always points into the sandbox, it can always safely be written to, but when reading from it, it must be assumed that the data has been corrupted by an attacker.<br  />
 <b>Design Document</b>: <a href="https://docs.google.com/document/d/10qh2-b4C5OtSg-xLwyZpEI5ZihVBPtn1xwKBbQC26yI/edit?usp=sharing">Compressed pointers in V8</a></p>
<h2><a class="anchor" id="autotoc_md15"></a>
Uncompressed/Full Pointer</h2>
<p><b>Summary</b>: A full (64-bit) pointer to a V8 HeapObject.<br  />
 <b>Implementation</b>: These are regular (“raw”) pointers to HeapObjects. They appear for example after decompressing a compressed pointer when loading it into a register or onto the stack, or as fields in objects located outside of the sandbox, for example tracking data structures used by the GC or the compilers, or objects created by the Embedder. <br  />
 <b>Security Properties</b>: As these are raw pointers, they must not be corrupted by an attacker and so must only be used outside of the sandbox. As they also point into the sandbox, the same considerations as for Compressed Pointers apply, namely that it must be assumed that what they point to has been corrupted.<br  />
</p>
<h2><a class="anchor" id="autotoc_md16"></a>
Sandboxed Pointer</h2>
<p><b>Summary</b>: A pointer that is guaranteed to point into the sandbox.<br  />
 <b>Implementation</b>: A sandboxed pointer is a 40-bit offset (when the sandbox is 1TB large) that is added to the base of the sandbox when loaded. When the sandbox is disabled, they are regular full pointers.<br  />
 <b>Security Properties</b>: As this pointer always points into the sandbox, it can always safely be written to, but when reading from it, it must be assumed that the data has been corrupted by an attacker.<br  />
 <b>Design Document</b>: <a href="https://docs.google.com/document/d/1HSap8-J3HcrZvT7-5NsbYWcjfc0BVoops5TDHZNsnko/edit?usp=sharing">V8 Sandbox - Sandboxed Pointers</a></p>
<h2><a class="anchor" id="autotoc_md17"></a>
Protected Pointer</h2>
<p><b>Summary</b>: A pointer that cannot be modified by an attacker. Only used between TrustedObjects.<br  />
 <b>Implementation</b>: These are implemented as compressed pointers but use the trusted space base instead of the in-sandbox heap base. It’s therefore guaranteed that they will always point into trusted space. As the pointer itself is also located in trusted space, it cannot directly be modified by an attacker. When the sandbox is disabled, they are regular tagged pointers.<br  />
 <b>Security Properties</b>: Neither the pointer itself nor the pointed-to object can be modified by an attacker as both live in trusted space. These pointers therefore have the strongest security guarantees.<br  />
 <b>Design Document</b>: <a href="https://docs.google.com/document/d/1IrvzL4uX_Zv0k2Iakdp_q_z33bj-qlYF5IesGpXW0fM/edit?usp=sharing">V8 Sandbox - Trusted Space</a></p>
<h2><a class="anchor" id="autotoc_md18"></a>
External Pointer</h2>
<p><b>Summary</b>: A pointer to an object external to V8, outside of the sandbox and not managed by V8’s GC.<br  />
 <b>Implementation</b>: These are implemented as indices into the ExternalPointerTable (EPT), which is located outside of the sandbox. The EPT performs type checks on every access to a pointer. Conceptually, they are very similar to file descriptors in Unix. When the sandbox is disabled, they are regular full pointers.<br  />
 <b>Security Properties</b>: The pointer will point to a valid object of the expected type. However, an attacker can swap these pointers as long as the type of the referenced object is the same.<br  />
 <b>Design Document</b>: <a href="https://docs.google.com/document/d/1HSap8-J3HcrZvT7-5NsbYWcjfc0BVoops5TDHZNsnko/edit?usp=sharing">V8 Sandbox - External Pointer Sandboxing</a></p>
<h2><a class="anchor" id="autotoc_md19"></a>
Indirect Pointer</h2>
<p><b>Summary</b>: A pointer to a V8 HeapObject that goes through a pointer table indirection on access.<br  />
 <b>Implementation</b>: The “under-the-hood” implementation of Trusted Pointers and Code Pointers (see below) when the sandbox is enabled. Similar to External Pointers, these are indices into a pointer table and perform type checks on access. These pointers are only available when the sandbox is enabled.<br  />
 <b>Security Properties</b>: See Trusted Pointer.<br  />
 <b>Design Document</b>: <a href="https://docs.google.com/document/d/1IrvzL4uX_Zv0k2Iakdp_q_z33bj-qlYF5IesGpXW0fM/edit?usp=sharing">V8 Sandbox - Trusted Space</a></p>
<h2><a class="anchor" id="autotoc_md20"></a>
Trusted Pointer</h2>
<p><b>Summary</b>: A pointer that is guaranteed to point to a valid TrustedObject in trusted space.<br  />
 <b>Implementation</b>: These are implemented as Indirect Pointers using the TrustedPointerTable (TPT) when the sandbox is enabled. Otherwise they are regular tagged pointers.<br  />
 <b>Security Properties</b>: The pointer will point to a TrustedObject in trusted space of the expected type. However, as with External Pointers an attacker can perform “pointer swap attacks” so it is not guaranteed that the pointer still points to the “original” object.<br  />
 <b>Design Document</b>: <a href="https://docs.google.com/document/d/1IrvzL4uX_Zv0k2Iakdp_q_z33bj-qlYF5IesGpXW0fM/edit?usp=sharing">V8 Sandbox - Trusted Space</a></p>
<h2><a class="anchor" id="autotoc_md21"></a>
Code Pointer</h2>
<p><b>Summary</b>: A special kind of Trusted Pointer that always points to a Code object.<br  />
 <b>Implementation</b>: Similar to Trusted Pointers, but these use the CodePointerTable (CPT) instead of the TPT. They are essentially a performance optimization as the CPT also directly points to the code’s entrypoint.<br  />
 <b>Security Properties</b>: Same as Trusted Pointers, but will always point to a Code object.<br  />
 <b>Design Document</b>: <a href="https://docs.google.com/document/d/1CPs5PutbnmI-c5g7e_Td9CNGh5BvpLleKCqUnqmD82k/edit?usp=sharing">V8 Sandbox - Code Pointer Sandboxing</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 3 2025 08:20:26 for v8 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
